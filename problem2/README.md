As you can see from the refactored Scala code I am huge believer in purely typed Functional Programming.
Didn't add comments because I didn't have time although all functions and implementations are self-explanatory.
I tried to have 100% test coverage but as you see not every scenario is tested but as tests are glued together anyway everything is covered.
To run the tests: `sbt test`

